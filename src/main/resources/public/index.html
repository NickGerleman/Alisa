<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Async Test</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>
<body>
<div id="stream">

</div>
<script>
    $(function() {
        (function stream() {

            $.post("/stream")
                .done(function(obj) {
                        var streamDiv = $('#stream');
                        obj.updates.forEach(function(update) {
                            console.log(update);
                            streamDiv.append('<p>' + update.description + '</p>');
                        });
                        stream();
                })
                .fail(function() {
                        setTimeout(stream, 1000);
                    });

        })();
    })
</script>
</body>
</html>